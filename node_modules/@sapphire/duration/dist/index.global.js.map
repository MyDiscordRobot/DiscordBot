{"version":3,"sources":["../src/index.ts","../src/lib/constants.ts","../src/lib/Duration.ts","../src/lib/DurationFormatter.ts"],"sourcesContent":["export * from './lib/constants';\nexport * from './lib/Duration';\nexport * from './lib/DurationFormatter';\n","import type { DurationFormatAssetsTime, DurationFormatSeparators } from './DurationFormatter';\n\nexport enum Time {\n\tMillisecond = 1,\n\tSecond = 1000,\n\tMinute = 1000 * 60,\n\tHour = 1000 * 60 * 60,\n\tDay = 1000 * 60 * 60 * 24,\n\tMonth = 1000 * 60 * 60 * 24 * (365 / 12),\n\tYear = 1000 * 60 * 60 * 24 * 365\n}\n\n/**\n * The supported time types\n */\nexport enum TimeTypes {\n\tSecond = 'second',\n\tMinute = 'minute',\n\tHour = 'hour',\n\tDay = 'day',\n\tWeek = 'week',\n\tMonth = 'month',\n\tYear = 'year'\n}\n\nexport const DEFAULT_UNITS: DurationFormatAssetsTime = {\n\t[TimeTypes.Year]: {\n\t\t1: 'year',\n\t\tDEFAULT: 'years'\n\t},\n\t[TimeTypes.Month]: {\n\t\t1: 'month',\n\t\tDEFAULT: 'months'\n\t},\n\t[TimeTypes.Week]: {\n\t\t1: 'week',\n\t\tDEFAULT: 'weeks'\n\t},\n\t[TimeTypes.Day]: {\n\t\t1: 'day',\n\t\tDEFAULT: 'days'\n\t},\n\t[TimeTypes.Hour]: {\n\t\t1: 'hour',\n\t\tDEFAULT: 'hours'\n\t},\n\t[TimeTypes.Minute]: {\n\t\t1: 'minute',\n\t\tDEFAULT: 'minutes'\n\t},\n\t[TimeTypes.Second]: {\n\t\t1: 'second',\n\t\tDEFAULT: 'seconds'\n\t}\n};\n\nexport const DEFAULT_SEPARATORS: DurationFormatSeparators = {\n\tleft: ' ',\n\tright: ' '\n};\n","/* eslint-disable @typescript-eslint/restrict-plus-operands */\nconst tokens = new Map([\n\t['nanosecond', 1 / 1e6],\n\t['nanoseconds', 1 / 1e6],\n\t['ns', 1 / 1e6],\n\n\t['millisecond', 1],\n\t['milliseconds', 1],\n\t['ms', 1],\n\n\t['second', 1000],\n\t['seconds', 1000],\n\t['sec', 1000],\n\t['secs', 1000],\n\t['s', 1000],\n\n\t['minute', 1000 * 60],\n\t['minutes', 1000 * 60],\n\t['min', 1000 * 60],\n\t['mins', 1000 * 60],\n\t['m', 1000 * 60],\n\n\t['hour', 1000 * 60 * 60],\n\t['hours', 1000 * 60 * 60],\n\t['hr', 1000 * 60 * 60],\n\t['hrs', 1000 * 60 * 60],\n\t['h', 1000 * 60 * 60],\n\n\t['day', 1000 * 60 * 60 * 24],\n\t['days', 1000 * 60 * 60 * 24],\n\t['d', 1000 * 60 * 60 * 24],\n\n\t['week', 1000 * 60 * 60 * 24 * 7],\n\t['weeks', 1000 * 60 * 60 * 24 * 7],\n\t['wk', 1000 * 60 * 60 * 24 * 7],\n\t['wks', 1000 * 60 * 60 * 24 * 7],\n\t['w', 1000 * 60 * 60 * 24 * 7],\n\n\t['month', 1000 * 60 * 60 * 24 * (365.25 / 12)],\n\t['months', 1000 * 60 * 60 * 24 * (365.25 / 12)],\n\t['b', 1000 * 60 * 60 * 24 * (365.25 / 12)],\n\t['mo', 1000 * 60 * 60 * 24 * (365.25 / 12)],\n\n\t['year', 1000 * 60 * 60 * 24 * 365.25],\n\t['years', 1000 * 60 * 60 * 24 * 365.25],\n\t['yr', 1000 * 60 * 60 * 24 * 365.25],\n\t['yrs', 1000 * 60 * 60 * 24 * 365.25],\n\t['y', 1000 * 60 * 60 * 24 * 365.25]\n]);\n\n/**\n * Converts duration strings into ms and future dates\n */\nexport class Duration {\n\t/**\n\t * The offset\n\t */\n\tpublic offset: number;\n\n\t/**\n\t * Create a new Duration instance\n\t * @param pattern The string to parse\n\t */\n\tpublic constructor(pattern: string) {\n\t\tthis.offset = Duration.parse(pattern.toLowerCase());\n\t}\n\n\t/**\n\t * Get the date from now\n\t */\n\tpublic get fromNow(): Date {\n\t\treturn this.dateFrom(new Date());\n\t}\n\n\t/**\n\t * Get the date from\n\t * @param date The Date instance to get the date from\n\t */\n\tpublic dateFrom(date: Date): Date {\n\t\treturn new Date(date.getTime() + this.offset);\n\t}\n\n\t/**\n\t * The RegExp used for the pattern parsing\n\t */\n\tprivate static readonly kPatternRegex = /(-?\\d*\\.?\\d+(?:e[-+]?\\d+)?)\\s*([a-zÎ¼]*)/gi;\n\n\t/**\n\t * The RegExp used for removing commas\n\t */\n\tprivate static readonly kCommaRegex = /,/g;\n\n\t/**\n\t * The RegExp used for replacing a/an with 1\n\t */\n\tprivate static readonly kAanRegex = /\\ban?\\b/gi;\n\n\t/**\n\t * Parse the pattern\n\t * @param pattern The pattern to parse\n\t */\n\tprivate static parse(pattern: string): number {\n\t\tlet result = 0;\n\t\tlet valid = false;\n\n\t\tpattern\n\t\t\t// ignore commas\n\t\t\t.replace(Duration.kCommaRegex, '')\n\t\t\t// a / an = 1\n\t\t\t.replace(Duration.kAanRegex, '1')\n\t\t\t// do math\n\t\t\t.replace(Duration.kPatternRegex, (_, i, units) => {\n\t\t\t\tconst token = tokens.get(units);\n\t\t\t\tif (token !== undefined) {\n\t\t\t\t\tresult += Number(i) * token;\n\t\t\t\t\tvalid = true;\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t});\n\n\t\treturn valid ? result : NaN;\n\t}\n}\n","import { DEFAULT_SEPARATORS, DEFAULT_UNITS, TimeTypes } from './constants';\n\n/**\n * The duration of each time type in milliseconds\n */\nconst kTimeDurations: readonly [TimeTypes, number][] = [\n\t[TimeTypes.Year, 31536000000],\n\t// 29.53059 days is the official duration of a month: https://en.wikipedia.org/wiki/Month\n\t[TimeTypes.Month, 2628000000],\n\t[TimeTypes.Week, 1000 * 60 * 60 * 24 * 7],\n\t[TimeTypes.Day, 1000 * 60 * 60 * 24],\n\t[TimeTypes.Hour, 1000 * 60 * 60],\n\t[TimeTypes.Minute, 1000 * 60],\n\t[TimeTypes.Second, 1000]\n];\n\n/**\n * Display the duration\n * @param duration The duration in milliseconds to parse and display\n * @param assets The language assets\n */\nexport class DurationFormatter {\n\tpublic constructor(public units: DurationFormatAssetsTime = DEFAULT_UNITS) {}\n\n\tpublic format(\n\t\tduration: number,\n\t\tprecision = 7,\n\t\t{\n\t\t\tleft: leftSeparator = DEFAULT_SEPARATORS.left,\n\t\t\tright: rightSeparator = DEFAULT_SEPARATORS.right\n\t\t}: DurationFormatSeparators = DEFAULT_SEPARATORS\n\t) {\n\t\tconst output: string[] = [];\n\t\tconst negative = duration < 0;\n\t\tif (negative) duration *= -1;\n\n\t\tfor (const [type, timeDuration] of kTimeDurations) {\n\t\t\tconst division = duration / timeDuration;\n\t\t\tif (division < 1) continue;\n\n\t\t\tconst floored = Math.floor(division);\n\t\t\tduration -= floored * timeDuration;\n\t\t\toutput.push(addUnit(floored, this.units[type], leftSeparator!));\n\n\t\t\t// If the output has enough precision, break\n\t\t\tif (output.length >= precision) break;\n\t\t}\n\n\t\treturn `${negative ? '-' : ''}${output.join(rightSeparator) || addUnit(0, this.units.second, leftSeparator!)}`;\n\t}\n}\n\n/**\n * Adds an unit, if non zero\n * @param time The duration of said unit\n * @param unit The unit language assets\n */\nfunction addUnit(time: number, unit: DurationFormatAssetsUnit, separator: string) {\n\tif (Reflect.has(unit, time)) return `${time}${separator}${Reflect.get(unit, time)}`;\n\treturn `${time}${separator}${unit.DEFAULT}`;\n}\n\nexport interface DurationFormatSeparators {\n\tleft?: string;\n\tright?: string;\n}\n\nexport interface DurationFormatAssetsUnit extends Record<number, string> {\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tDEFAULT: string;\n}\n\nexport interface DurationFormatAssetsTime {\n\t[TimeTypes.Second]: DurationFormatAssetsUnit;\n\t[TimeTypes.Minute]: DurationFormatAssetsUnit;\n\t[TimeTypes.Hour]: DurationFormatAssetsUnit;\n\t[TimeTypes.Day]: DurationFormatAssetsUnit;\n\t[TimeTypes.Week]: DurationFormatAssetsUnit;\n\t[TimeTypes.Month]: DurationFormatAssetsUnit;\n\t[TimeTypes.Year]: DurationFormatAssetsUnit;\n}\n"],"mappings":"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","names":["Time","TimeTypes"]}